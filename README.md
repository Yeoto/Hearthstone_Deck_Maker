# 0. 해당 유틸의 개발 목적

- 돌겜에 들어가지 않더라도, 덱을 만들 수 있는 환경을 만들기 위함.

- 기존 돌겜 덱 메이커보다 성능 자체를 뛰어나게 만들어 놓기 위함.

- 기존 돌겜 덱 메이커의 불편한 점을 최대한 개선하여 사용하기 편하게 하기 위함.



# 1. 개발 환경

- Visual Studio 2017

- MFC



# 2. 사용 라이브러리 및 API

- curl ssl ( api get 용도 )

- https://hearthstoneapi.com/ ( 카드 데이터 불러오는 용도 )

- https://hearthstonejson.com/ (카드 이미지 불러오는 용도 )

- api가 두개 다른 이유는 원래 위 api 기준으로 개발하다가 이미지 관련해서 오류가 너무 심해서 이미지만 아래 api로 불러오도록 했음 ㅎㅎ;



# 3. 주요 기능 별 정보

## 1) 카드 파싱 및 데이터 캐싱

- 카드 데이터 같은 경우 위 api중 위 링크에 있는거 가져와서 json으로 파싱했고, 카드 이미지 같은 경우 아래 api 사용해서 파일로 저장해서 불러와서 썼음

- 이미지 로딩 관련된게 념글에 올라와있던 로딩 관련된 부분임

- 짧고 렉걸리는거 = 필요한 이미지 불러옴, 길고 렉 안걸리는거 = 모든 이미지 캐싱해놓고 가져다 씀

- ㅅㅂ 짧고 렉걸리는거 vs 길고 렉 안걸리는거 고르랬더니 짧고 렉 안걸리는거 만들어 달라는 인성 터진것들이 존나 많더라

- 그래서 짧고 초반 렉 조금 있는 정도 되도록 개선했음

- 멀티스레드로 필요한 이미지 있으면 우선적으로 필요한 이미지 가져오고 나머지는 이미지 계속 캐싱하고 있음

- 기본적으로 이미지가 없으면 다운받는 방식이기 때문에, 몇개 없어진다고 실행에 영향은 주지 않음

- 단, 그냥 있는 이미지 불러오는거 보다는 다운받고 가져오는게 훨씬 느리다는거 주의

- 그리고 폴더 안에 temp.png파일은 지우면 프로그램 실행 안되니까 주의



## 2) 카드 리스트 ( 왼쪽에 카드 배열되어있는 부분 )

- 일단 기존 돌겜과 카드 정렬 방식은 똑같음. (코스트 -> 카드이름 순서)

- 우클릭 하면 덱에 들어감

- 줌인 줌아웃 기능 넣었음. (Ctrl + 휠 위/아래) 당연히 휠 아래가 줌 아웃임

- 마우스 휠로 페이지 넘기기 가능

- 물론 양 쪽 끝 부분 눌러도 넘어감

- 원래 돌겜처럼 각 직업별 페이지 끝에서 다음 버튼 누르면 다음 직업 넘어가게 만드려다가 휠로 넘기는거 만들면서 뺐음

- 프로그램 창 크기 바꾸면 그거 맞춰서 카드 갯수 다시 만듬



## 3) 덱 리스트 (오른쪽에 카드 들어가있는 부분)

- 기존 돌겜과 정렬 방식 같음 ( 코스트 -> 카드이름 순서 )

- 카드 이미지 가져오는 부분 빼버렸음. 성능을 위해서

- 우클릭 하면 덱에서 빠짐

- 근데 이거 만들고 올리다가 생각 난건데 마우스 반대아닌가?



## 4) 덱 불러오기 / 내보내기

- 모든 기능 돌겜과 호환됨

- 단 이때 같은 덱이 코드는 다를 수 있음. 이유는 아래 후술

- 기본적인 원리는

1 - 카드 별 dbfID라는 카드 고유의 값이 있음 ( 변신 박붐의 코드는 48146 )

2 - 이걸 각 7bit 씩 뒤에서부터 나누어서 ( 48146이라는 값을 뒤에서부터 7bit씩 나누면 10 1111000 0010010

3 - 순서를 뒤집어서 배치, 맨 마지막 7bit 빼고 8번째 비트에 1을 넣음 ( 10010010 11111000 00000010 )

4 - 이걸 BASE64라는 암호화 방식으로 인코딩 함 ( 이건 나무위키 가서 보셈 )

5 - 카드/영웅은 해당 원리 적용하고, 덱 코드는 0 1(고정) 2(야생/정규) 1(고정) (영웅코드) 1장짜리 카드 갯수 (카드들) 2장짜리 카드 갯수 (카드들) 순서로 뽑는다

- 근데 이 방식으로 만들면 카드 순서에 따라서 코드가 달라질수가 있다는 말이였음.

- 덱리에서는 돌겜이랑 똑같이 보여도 실제 코드 뽑을 때는 최대한 쓸모없는 짓 안하고 그냥 뽑으니까 돌겜이랑 다르더라고



## 5) 덱 필터링 기능



- 세부 필터링 가능

- 근데 저거 카드팩 부분은 풀네임 쓰기는 너무 길어서 못썼다

- 근데 줄임말도 좀 맘에 안듬. 저건 좀 추천좀 해줘라



# 4. 개발 예정 사항

- HSReplay에서 직업별 메타 덱 바로 불러오기 기능

- 카드 즐겨찾기 기능 추가

- ui 디자인 개선. 사실 잘 보면 알겠지만 맨위에 직업 선택하는 부분 좌우 간격 안맞는다.

- 카드 리스트 중앙에 위치 하도록. 지금은 좌측 상단에 딱 맞춰서 출력하게 되어있음.

- 덱리에 전설하수인 별 달아주기.

- 덱리 카드 빼는거 마우스 왼쪽으로 옮기고, 클릭하면 해당 카드 찾아가게 수정
